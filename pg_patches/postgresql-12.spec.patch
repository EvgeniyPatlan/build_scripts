--- percona-postgresql-12.spec	2019-12-21 17:55:50.000000000 +0200
+++ percona-postgresql-12.spec	2019-12-21 19:49:39.000000000 +0200
@@ -4,6 +4,7 @@
 %global pgpackageversion 12
 %global prevmajorversion 11
 %global sname postgresql
+%global vname postgresql12
 %global pgbaseinstdir	/usr/pgsql-%{pgmajorversion}
 
 %global beta 0
@@ -82,13 +83,13 @@
 %endif
 
 Summary:	PostgreSQL client programs and libraries
-Name:		%{sname}%{pgmajorversion}
+Name:		percona-postgresql%{pgmajorversion}
 Version:	12.1
-Release:	2PGDG%{?dist}
+Release:	2%{?dist}
 License:	PostgreSQL
 Url:		https://www.postgresql.org/
 
-Source0:	https://download.postgresql.org/pub/source/v%{version}/postgresql-%{version}.tar.bz2
+Source0:	percona-postgresql-%{version}.tar.gz
 Source4:	%{sname}-%{pgmajorversion}-Makefile.regress
 Source5:	%{sname}-%{pgmajorversion}-pg_config.h
 %if %{systemd_enabled}
@@ -98,7 +99,7 @@
 %endif
 Source7:	%{sname}-%{pgmajorversion}-ecpg_config.h
 Source9:	%{sname}-%{pgmajorversion}-libs.conf
-Source12:	https://www.postgresql.org/files/documentation/pdf/%{pgpackageversion}/%{sname}-%{pgpackageversion}-A4.pdf
+Source12:	https://www.postgresql.org/files/documentation/pdf/%{pgmajorversion}/%{sname}-%{pgmajorversion}-A4.pdf
 Source14:	%{sname}-%{pgmajorversion}.pam
 Source16:	%{sname}-%{pgmajorversion}-filter-requires-perl-Pg.sh
 Source17:	%{sname}-%{pgmajorversion}-setup
@@ -302,6 +303,9 @@
 Requires:	openssl-libs >= 1.0.2k
 %endif
 %endif
+Provides:	%{vname}-libs = %{pgmajorversion}
+Conflicts:	postgresql-libs = %{pgmajorversion}
+Conflicts:	%{vname}-libs = %{pgmajorversion}
 
 %ifarch ppc64 ppc64le
 AutoReq:	0
@@ -338,6 +342,9 @@
 Requires:	/usr/sbin/useradd, /sbin/chkconfig
 %endif
 Provides:	postgresql-server >= %{version}-%{release}
+Provides:	%{vname}-server
+Conflicts:	postgresql-server
+Conflicts:	%{vname}-server
 
 %ifarch ppc64 ppc64le
 AutoReq:	0
@@ -353,6 +360,9 @@
 %package docs
 Summary:	Extra documentation for PostgreSQL
 Provides:	postgresql-docs >= %{version}-%{release}
+Provides:	%{vname}-docs
+Conflicts:	postgresql-docs
+Conflicts:	%{vname}-docs
 
 %description docs
 The postgresql%{pgmajorversion}-docs package includes the SGML source for the documentation
@@ -366,6 +376,9 @@
 Requires:	%{name}%{?_isa} = %{version}-%{release}
 Requires:	%{name}-libs%{?_isa} = %{version}-%{release}
 Provides:	postgresql-contrib >= %{version}-%{release}
+Provides:	%{vname}-contrib
+Conflicts:	postgresql-contrib
+Conflicts:	%{vname}-contrib
 
 %ifarch ppc64 ppc64le
 AutoReq:	0
@@ -400,6 +413,8 @@
 %endif
 
 Provides:	postgresql-devel >= %{version}-%{release}
+Provides:	%{vname}-devel
+Conflicts:	%{vname}-devel
 
 %ifarch ppc64 ppc64le
 AutoReq:	0
@@ -427,6 +442,9 @@
 %endif
 %endif
 Provides:	postgresql-llvmjit >= %{version}-%{release}
+Provides:	%{vname}-llvmjit
+Conflicts:	postgresql-llvmjit
+Conflicts:	%{vname}-llvmjit
 
 %ifarch ppc64 ppc64le
 AutoReq:	0
@@ -450,6 +468,9 @@
 %endif
 Obsoletes:	postgresql%{pgmajorversion}-pl <= %{version}-%{release}
 Provides:	postgresql-plperl >= %{version}-%{release}
+Provides:	%{vname}-plperl
+Conflicts:	postgresql-plperl
+Conflicts:	%{vname}-plperl
 
 %ifarch ppc64 ppc64le
 AutoReq:	0
@@ -476,6 +497,9 @@
 %else
 Requires:	python2-libs
 %endif
+Conflicts:	postgresql-plpython
+Provides:	%{name}-plpython2%{?_isa} = %{version}-%{release}
+Conflicts:	%{name}-plpython2%{?_isa} = %{version}-%{release}
 
 %ifarch ppc64 ppc64le
 AutoReq:	0
@@ -502,6 +526,9 @@
 %else
 Requires:	python3-libs
 %endif
+Provides:	%{vname}-plpython3
+Conflicts:	postgresql-plpython3
+Conflicts:	%{vname}-plpython3
 
 %ifarch ppc64 ppc64le
 AutoReq:	0
@@ -523,6 +550,9 @@
 Requires:	tcl
 Obsoletes:	%{name}-pl <= %{version}-%{release}
 Provides:	postgresql-pltcl >= %{version}-%{release}
+Provides:	%{vname}-pltcl
+Conflicts:	postgresql-pltcl
+Conflicts:	%{vname}-pltcl
 
 %ifarch ppc64 ppc64le
 AutoReq:	0
@@ -541,6 +571,9 @@
 Requires:	%{name}-server%{?_isa} = %{version}-%{release}
 Requires:	%{name}-devel%{?_isa} = %{version}-%{release}
 Provides:	postgresql-test >= %{version}-%{release}
+Provides:	%{vname}-test
+Conflicts:	postgresql-test
+Conflicts:	%{vname}-test
 
 %ifarch ppc64 ppc64le
 AutoReq:	0
@@ -556,7 +589,7 @@
 %global __perl_requires %{SOURCE16}
 
 %prep
-%setup -q -n %{sname}-%{version}
+%setup -q -n percona-postgresql-%{version}
 %patch1 -p0
 %patch3 -p0
 %patch5 -p0
@@ -863,6 +896,7 @@
 	%{__make} all
 	popd
 %endif
+pushd doc/src; make all; popd
 
 %install
 %{__rm} -rf %{buildroot}
